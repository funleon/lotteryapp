# LotteryApp - 抽獎應用程式

Design by Leon

這是一個基於 WinUI 3 開發的桌面抽獎應用程式，專為公司或團體活動設計，提供「獎品抽獎」與「賓果抽獎」兩種模式，並具備優雅的深色玻璃風格與現代化介面。

## 功能特色

### 1. 獎品抽獎 (Prize Draw)
-   **名單匯入**：支援從 Excel (`drawlist.xlsx`) 匯入抽獎名單 (包含部門、工號、姓名)。
-   **獎項設定**：支援從 Excel (`prize.xlsx`) 匯入獎項清單與數量。
-   **彈性抽獎**：
    -   可自訂一次抽取的得獎人數。
    -   預設抽取人數自動帶入該獎項總數。
    -   **視覺優化**：多人抽獎時，介面會逐一顯示中獎者，並具備強調色樣式的抽獎按鈕。
-   **防重複機制**：
    -   已中獎人員自動排除，不會再次中獎。
    -   嚴格控制獎項數量，防止超額抽選。
-   **介面資訊**：
    -   即時顯示總獎數與已中獎數。
    -   中獎清單保留簡潔的設計，隱藏重複的獎項名稱並將清單內容置中。

### 2. 賓果抽獎 (Bingo Draw)
-   **自訂範圍**：可自由設定抽獎數字範圍。
-   **不重複抽選**：系統採用嚴謹的亂數演算法，確保抽出的數字不會重複。
-   **歷史紀錄**：即時顯示所有已抽出的數字歷史紀錄。

### 3. 其他功能
-   **關於頁面**：內建版本資訊、授權條款 (MIT License) 及開發資訊展示。
-   **自動初始化**：首次執行時若發現缺少必要的 Excel 檔案，系統會主動建立附帶標題欄位的空白 Excel 檔，方便使用者直接進行編輯。

## 抽獎邏輯說明 (Draw Logic)

本系統嚴謹採用電腦 **亂數演算法 (Random Number Generation)** 進行抽選，確保結果公平公正。

-   **獎品抽獎邏輯**：
    1.  程式將匯總所有符合資格（未曾在其他獎項中獎）的候選人名單。
    2.  利用 `.NET` 框架的 `System.Random` 產生亂數，從候選人清單中隨機選取對應索引的人員作為中獎者。
-   **賓果抽獎邏輯**：
    1.  在使用者設定的最小值與最大值之間產生亂數。
    2.  系統會比對歷史紀錄，若產生的數字已經被抽過，則會重新產生，直到產生一個「未重複」的數字為止。

## 安裝與執行 (Installation)

### 免安裝版 (Portable Version)
本專案採用 **Self-Contained (獨立部署)** 模式發行，因此使用者不需要在電腦上安裝 `.NET` 執行階段。
1. 下載 `LotteryApp_Portable.zip`。
2. 將壓縮檔解壓縮至任何您想要的資料夾。
3. 直接點擊資料夾內的 `LotteryApp.exe` 即可開啟應用程式。

### 自行編譯 (Build from Source)
1.  **環境環境**: 安裝 Visual Studio 2022 與 .NET 8 SDK，並確保已勾選「通用 Windows 平台開發」及「Windows App SDK」。
2.  **開啟專案**: 雙擊開啟 `lotteryapp.sln`。
3.  **依賴套件**: 在方案總管中，右鍵點擊方案並選擇「還原 NuGet 套件」。
4.  **發布操作**: 
    - 您可以直接按下 `F5` 進行本地端偵錯與執行。
    - 本專案提供 PowerShell 腳本 `publish.ps1`，您可透過 PowerShell 執行該腳本。腳本會自動清理環境、編譯、打包成 Win-x64 Self-Contained 格式，並將結果輸出至 `Dist` 資料夾與打包成免安裝的 `LotteryApp_Portable.zip`。

## 操作教學與細節 (Operation Guide)

### 前置作業：準備資料檔案
本程式深度依賴 Excel 檔案作為資料來源與儲存目標。請確保這些檔案與主程式位於同一個執行目錄中。
**建議的建立流程：**
1. 先開啟一次 `LotteryApp.exe` 讓系統自動產生所需的範本檔案。
2. 關閉程式後，開啟執行目錄並編輯 `drawlist.xlsx`：填入 **部門 (DeptId)**、**工號 (Id)**、**姓名 (Name)**。
3. 編輯 `prize.xlsx`：填入 **獎項名稱 (PrizeName)** 和該獎項的 **名額 (Num)**。

| 檔案名稱 | 用途 | 欄位需求 | 備註 |
| :--- | :--- | :--- | :--- |
| `drawlist.xlsx` | 抽獎人員名單 | 部門, 工號, 姓名 | 抽獎前須填寫完畢 |
| `prize.xlsx` | 獎項清單 | 獎項名稱, 名額 | 抽獎前須填寫完畢 |
| `winner.xlsx` | 中獎結果紀錄 | (系統自動產生) | **自動即時儲存**，中途請勿保持開啟 |
| `bingo.xlsx` | 賓果紀錄 | (系統自動產生) | **自動即時儲存**，中途請勿保持開啟 |

### 進行獎品抽獎
1. 打開程式，停留在左側導覽列的 **[抽獎]** 標籤頁。
2. 畫面頂端會顯示總獎數與目前已抽出的獎數。
3. 依照您的需求，調整「單次抽出人數」。預設值會為該獎項剩餘的名額，您也可以手動設為 1 以逐一抽出增加緊張感。
4. 點選 **[抽獎]** 按鈕。右側名單隨即會展示中獎者的部門、工號與姓名，同時名單會立刻寫入 `winner.xlsx`。

### 進行賓果抽獎
1. 點擊左側導覽列的 **[賓果]** 標籤頁。
2. 在輸入框中設定號碼的「最大值」（預設為 75）。
3. 點選 **[抽出號碼]** 按鈕。
4. 每次點擊將產生一個不重複的號碼，並直接顯示於大畫面上。所有已抽出的歷史號碼將會整合於下方區域，同時自動寫入 `bingo.xlsx`。

## 開發環境與架構
-   **開發語言**: C#
-   **環境框架**: .NET 8
-   **UI 框架**: WinUI 3 (Windows App SDK)
-   **架構模式**: MVVM (Model-View-ViewModel)
-   **Nuget 套件**: 
    -   `ClosedXML` (處理 Excel 讀寫)
    -   `CommunityToolkit.Mvvm` (MVVM 支援)
    -   `CommunityToolkit.WinUI.UI.Controls.DataGrid` (表格介面顯示)

---
*文件更新日期: 2026-02-22*
