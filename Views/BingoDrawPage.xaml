<?xml version="1.0" encoding="utf-8"?>
<Page
    x:Class="lotteryapp.Views.BingoDrawPage"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:local="using:lotteryapp.Views"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    xmlns:viewmodels="using:lotteryapp.ViewModels"
    mc:Ignorable="d">

    <Grid VerticalAlignment="Stretch" HorizontalAlignment="Stretch">
        <Grid.Background>
            <ImageBrush ImageSource="/Assets/background.png" Stretch="UniformToFill" Opacity="0.8"/>
        </Grid.Background>

        <Grid Padding="20">
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="*"/>
            </Grid.RowDefinitions>

            <!-- Title -->
            <TextBlock Text="{x:Bind ViewModel.Title}" Style="{StaticResource TitleTextBlockStyle}" 
                       Foreground="Black" 
                       HorizontalAlignment="Center" Margin="0,0,0,20"/>

            <!-- Controls -->
            <StackPanel Grid.Row="1" Orientation="Horizontal" HorizontalAlignment="Center" Spacing="20" Margin="0,0,0,30">
                <NumberBox Value="{x:Bind ViewModel.InputMinNum, Mode=TwoWay}" Minimum="1" Maximum="999" 
                           FontSize="20" Foreground="Black">
                    <NumberBox.Header>
                        <TextBlock Text="最小號碼 Min" Foreground="Black" FontWeight="Bold" />
                    </NumberBox.Header>
                </NumberBox>
                <NumberBox Value="{x:Bind ViewModel.InputMaxNum, Mode=TwoWay}" Minimum="1" Maximum="999" 
                           FontSize="20" Foreground="Black">
                    <NumberBox.Header>
                        <TextBlock Text="最大號碼 Max" Foreground="Black" FontWeight="Bold" />
                    </NumberBox.Header>
                </NumberBox>
                <NumberBox Value="{x:Bind ViewModel.InputDrawCount, Mode=TwoWay}" Minimum="1" Maximum="100" 
                           FontSize="20" Foreground="Black">
                    <NumberBox.Header>
                        <TextBlock Text="抽取個數 Count" Foreground="Black" FontWeight="Bold" />
                    </NumberBox.Header>
                </NumberBox>
                <Button Content="套用設定 Apply" Command="{x:Bind ViewModel.ApplySettingsCommand}" 
                        Style="{StaticResource AccentButtonStyle}" 
                        FontSize="20" Foreground="White"
                        VerticalAlignment="Bottom"/>
                <Button Content="抽號碼 Draw" Command="{x:Bind ViewModel.DrawCommand}" 
                        Style="{StaticResource AccentButtonStyle}" 
                        FontSize="20" Foreground="White"
                        VerticalAlignment="Bottom"/>
            </StackPanel>

            <!-- Rolling Display -->
            <Border Grid.Row="2" Background="#CCFFFFFF" 
                    CornerRadius="10" Padding="40" HorizontalAlignment="Center" Margin="0,0,0,30">
                <TextBlock Text="{x:Bind ViewModel.CurrentRollingNumber, Mode=OneWay}" 
                           FontSize="20"
                           HorizontalAlignment="Center" VerticalAlignment="Center"
                           Foreground="Black"/>
            </Border>

            <TextBlock Grid.Row="2" Text="{x:Bind ViewModel.StatusMessage, Mode=OneWay}" 
                       FontSize="20" Foreground="Red" 
                       HorizontalAlignment="Center" VerticalAlignment="Bottom" Margin="0,0,0,-20"/>

            <!-- History -->
            <StackPanel Grid.Row="3">
                <TextBlock Text="已抽出號碼 History:" Style="{StaticResource SubtitleTextBlockStyle}" 
                           FontSize="20" Foreground="Black" Margin="0,0,0,10"/>
                <GridView ItemsSource="{x:Bind ViewModel.DrawnNumbers, Mode=OneWay}" 
                          SelectionMode="None">
                    <GridView.ItemTemplate>
                        <DataTemplate>
                            <Border Background="#CCFFFFFF" 
                                    CornerRadius="50" Width="60" Height="60" Margin="5">
                                <TextBlock Text="{Binding}" HorizontalAlignment="Center" VerticalAlignment="Center" 
                                           FontSize="20" Foreground="Black"/>
                            </Border>
                        </DataTemplate>
                    </GridView.ItemTemplate>
                </GridView>
            </StackPanel>
        </Grid>
    </Grid>
</Page>
